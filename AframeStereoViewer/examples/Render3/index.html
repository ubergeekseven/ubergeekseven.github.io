<html>
  <head>
    <title>A-Frame Layer Component - Basic</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="../build.js"></script> <!-- In future builds create fully custom one that always points to this file somehwere in the root-->
    <!--animation component script-->

    <script src="https://unpkg.com/aframe-look-at-component@0.5.1/dist/aframe-look-at-component.min.js"></script>
    <script>
      AFRAME.registerComponent('hotspots',{
        init:function(){
            this.el.addEventListener('reloadspots',function(evt){
            
            //get the entire current spot group and scale it to 0
            var currspotgroup=document.getElementById(evt.detail.currspots);
            currspotgroup.setAttribute("scale","0 0 0");
            
            //get the entire new spot group and scale it to 1
            var newspotgroup=document.getElementById(evt.detail.newspots);
            newspotgroup.setAttribute("scale","1 1 1");
          });
        }
      });
      AFRAME.registerComponent('spot',{
        schema:{
          linkto:{type:"string",default:""},
          spotgroup:{type:"string",default:""}
        },
        init:function(){
          
          //add image source of hotspot icon
          this.el.setAttribute("src","#hotspot");
          //make the icon look at the camera all the time
          this.el.setAttribute("look-at","#camera");
          
          var data=this.data;
          
          this.el.addEventListener('click',function(){
            //set the skybox source to the new image as per the spot
            var sky=document.getElementById("sky1");
            sky.setAttribute("src",data.linkto);
            
            var spotcomp=document.getElementById("spots");
            var currspots=this.parentElement.getAttribute("id");
            //create event for spots component to change the spots data
            spotcomp.emit('reloadspots',{newspots:data.spotgroup,currspots:currspots});
          });
        }
      });
    </script>
  </head>
  <body>

    <a-scene renderer="antialias: true">
      <!-- Paths to left and right images -->
      <a-assets>
        <img id="left" src="textures/KitchenLeft.jpg">
        <img id="right" src="textures/KitchenRight.jpg">

        <img id="left1" src="textures/KitchenLeft.jpg">
        <img id="right1" src="textures/KitchenRight.jpg">
        <img id="left2" src="textures/KitchenLeft.jpg">
        <img id="right2" src="textures/KitchenRight.jpg">
        <img id="left3" src="textures/KitchenLeft.jpg">
        <img id="right3" src="textures/KitchenRight.jpg">

        <img id="hotspot" src="Hotspot.png"/>
      </a-assets>
      <a-entity id="spots" hotspots>
        <a-entity id="group-point1">
          <a-image spot="linkto:#Left2;spotgroup:group-point2" position="-4 0 10"></a-image>
        </a-entity>
        <a-entity id="group-point2" scale="0 0 0">
          <a-image spot="linkto:#Left1;spotgroup:group-point1" position="10 0 -8"></a-image>
          <a-image spot="linkto:#Left3;spotgroup:group-point3" position="0 0 10"></a-image>
        </a-entity>
        <a-entity id="group-point3" scale="0 0 0">
          <a-image spot="linkto:#Left2;spotgroup:group-point2" position="10 0 3"></a-image>
          <a-image spot="linkto:#Left4;spotgroup:group-point4" position="-10 0 -3"></a-image>
        </a-entity>
        <a-entity id="group-point4" scale="0 0 0">
          <a-image spot="linkto:#Left3;spotgroup:group-point3" position="0 0 -10"></a-image>
        </a-entity>
       </a-entity>
      <!-- Camera -->
      <a-entity camera look-controls position="0 0 0" stereocam="eye:left;"></a-entity>

      <!-- Sky sphere -->
      <a-sky id="sky1" src="#left" stereo="eye:left"></a-sky>
      <a-sky id="sky2" src="#right" stereo="eye:right"></a-sky>

      <!-- or alternatively -->

      <!--<a-sky id="sky1" src="http://i.imgur.com/YAaxpv6.jpg" stereo="eye:left"></a-sky>-->
      <!--<a-sky id="sky2" src="http://i.imgur.com/JUxTnzK.jpg" stereo="eye:right"></a-sky>-->

     

    </a-scene>

  </body>
</html>
